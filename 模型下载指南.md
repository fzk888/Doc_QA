# 模型下载指南

由于模型文件较大，我们将其排除在 Git 仓库之外。请按照以下步骤手动下载所需模型。

## 必需模型

### 1. BGE 嵌入模型 (bge-large-zh-v1.5)
- **用途**: 文档和查询的向量嵌入
- **大小**: 约 1.3GB
- **下载地址**: https://huggingface.co/BAAI/bge-large-zh-v1.5

### 2. BGE 重排序模型 (bge-reranker-large)
- **用途**: 对检索结果进行重新排序
- **大小**: 约 1.2GB
- **下载地址**: https://huggingface.co/BAAI/bge-reranker-large

## 下载方法

### 方法一：使用 Hugging Face CLI (推荐)

1. 安装 huggingface-hub:
```bash
pip install huggingface-hub
```

2. 下载嵌入模型:
```bash
huggingface-cli download BAAI/bge-large-zh-v1.5 --local-dir ./model/bge-large-zh-v1.5
```

3. 下载重排序模型:
```bash
huggingface-cli download BAAI/bge-reranker-large --local-dir ./model/bge-reranker-large
```

### 方法二：手动下载

1. 访问 Hugging Face 模型页面
2. 点击 "Files and versions" 标签
3. 下载所有文件到对应目录:
   - `bge-large-zh-v1.5` → `./model/bge-large-zh-v1.5/`
   - `bge-reranker-large` → `./model/bge-reranker-large/`

### 方法三：使用 modelscope (阿里魔搭)

如果 Hugging Face 访问困难，可以使用阿里魔搭:

```bash
pip install modelscope

# 下载嵌入模型
modelscope download --model baai/bge-large-zh-v1.5 --local_dir ./model/bge-large-zh-v1.5

# 下载重排序模型
modelscope download --model baai/bge-reranker-large --local_dir ./model/bge-reranker-large
```

## 目录结构

下载完成后，项目目录结构应该如下:

```
Doc_QA/
├── model/
│   ├── bge-large-zh-v1.5/
│   │   ├── config.json
│   │   ├── pytorch_model.bin
│   │   ├── tokenizer.json
│   │   └── ... (其他模型文件)
│   └── bge-reranker-large/
│       ├── config.json
│       ├── pytorch_model.bin
│       ├── tokenizer.json
│       └── ... (其他模型文件)
├── app.py
├── config.yaml
└── ... (其他文件)
```

## 验证下载

下载完成后，可以通过以下方式验证:

1. 检查文件是否存在:
```bash
ls -la ./model/bge-large-zh-v1.5/
ls -la ./model/bge-reranker-large/
```

2. 启动服务测试:
```bash
python app.py
```

如果模型加载成功，你应该能看到类似以下的日志:
```
Loading embedding model from ./model/bge-large-zh-v1.5
Loading reranker model from ./model/bge-reranker-large
Models loaded successfully!
```

## 常见问题

### Q: 下载速度很慢怎么办？
A: 可以尝试以下方法:
- 使用科学上网工具
- 选择网络较好的时段下载
- 使用多线程下载工具
- 考虑使用国内镜像源

### Q: 磁盘空间不足怎么办？
A: 确保有足够的磁盘空间(至少 3GB)，或者:
- 清理不必要的文件
- 使用较小的模型版本
- 考虑使用模型量化版本

### Q: 模型加载失败怎么办？
A: 检查以下几点:
- 模型文件是否完整下载
- 目录结构是否正确
- 权限设置是否正确
- Python 环境是否满足要求

## 注意事项

⚠️ **重要提醒**:
- 不要将模型文件提交到 Git 仓库
- 模型文件已在 `.gitignore` 中被忽略
- 生产环境中建议使用模型缓存或 CDN 加速